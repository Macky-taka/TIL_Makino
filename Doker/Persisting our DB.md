# Persisting our DB

今のtodoアプリはコンテナの起動ごとにデータが消える。なぜそうなるのか。コンテナがどのように動いているのかを確認しながら理解する。

### The container's filesystem

コンテナはイメージの様々なレイヤーを使用して起動する。
それぞれのコンテナは独自の「スクラッチスペース」を取得し、その中でファイルの生成、更新、削除を行う。それは同じイメージであったとしても、他のコンテナからは見えない、

##### 練習でのセッティング

２つのコンテナを起動して、ファイルを編集する。片方のコンテナでの編集は、別の方では利用できない。
```
docker run -d ubuntu bash -c "shuf -i 1-10000 -n 1 -o /data.txt && tail -f /dev/null"
```

bash shellを起動して２つのコマンドを呼び出す。最初はランダムな数値を/data.txtに書き出す。
２つ目は、コンテナを実行し続けるためにファイルを監視する。
アウトプットとをみれるのでdashboardからターミナルを開く。

### Container Volumes

ここんまでから、コンテナは起動時にイメージの定義から始めることがわかった。コンテナはファイルの作成、更新、削除を行うことができるがコンテナが削除されると失われ、全ての変更はそのコンテナ限りだ。
ボリュームを用いることで変更ができる。ボリュームは、コンテナの特定のファイルパスがホストマシンに接続できる機能がある。
コンテナ内のディテクトりがマウントされているとき、その変更はホストマシンにも影響する。コンテナを再起動しても同じディレクトリをマウントした時、同じファイルを参照できる。
ボリュームには２種類あるが、
named volumeを用いる。
