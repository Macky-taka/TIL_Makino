# パスワードを再設定する

### ```edit```アクション
基本的には11章と同じ。しかし少し面倒な点がある。それはメールアドレスをキーとしてユーザーを検索するためには、editアクションとupdateアクションの両方でメールアドレスが必要になる
ことだ。今回はこのメールアドレスを保持するため、隠しフィールドとしてページ内に保存する手法をとる。これにより、フォームから送信したときに、他の情報と一緒にメールアドレスが送信される。
```hidden_field_tag :email, @user.email```<br>
```f.hidden_field :email, @user.email```<br>
前者（hidden_field_tag）ではメールアドレスが```params[:email]```に保存されますが、後者では```params[:user][:email]```に保存される。
そして次に、このフォームを描画するためにPasswordResetsコントローラのeditアクション内で@userインスタンス変数を定義していく。

### テスト
送信成功と失敗の統合テストを作成する。<br>
アカウント有効化と共通が多いが違いもある。最初に「forgot password」フォームを表示して無効なメールアドレスを送信し、次はそのフォームで有効なメールアドレスを送信する。そして、後者ではパスワード再設定用トークンが作成され、再設定用メールが送信される。続いて、メールのリンクを開いて無効な情報を送信し、次にそのリンクから有効な情報を送信して、それぞれが期待どおりに動作することを確認する。
```
assert_select "input[name=email][type=hidden][value=?]", user.email
```
```input```タグに正しい名前、type="hidden"、メールアドレスがあるかどうかを確認
